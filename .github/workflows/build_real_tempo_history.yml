- name: Build real Tempo history (official RTE repo)
  run: |
    node <<'EOF'
    const fs = require("fs");
    const https = require("https");

    const YEARS = [
      "2016_2017","2017_2018","2018_2019","2019_2020",
      "2020_2021","2021_2022","2022_2023","2023_2024","2024_2025"
    ];

    const BASE_URL = "https://raw.githubusercontent.com/jbromain/rte-tempo/master/data";
    const output = [];

    function fetch(url) {
      return new Promise((resolve, reject) => {
        https.get(url, res => {
          let data = "";
          res.on("data", c => data += c);
          res.on("end", () => resolve(data));
        }).on("error", reject);
      });
    }

    (async () => {
      for (const y of YEARS) {
        const url = `${BASE_URL}/tempo_${y}.json`;
        try {
          console.log("ðŸ“¥ Fetch", url);
          const raw = await fetch(url);
          const json = JSON.parse(raw);

          json.forEach(d => {
            output.push({
              date: d.date,
              color: d.color
            });
          });
        } catch (e) {
          console.warn("âš ï¸ Skip year", y);
        }
      }

      output.sort((a,b) => a.date.localeCompare(b.date));

      fs.writeFileSync(
        "history_real_tempo.json",
        JSON.stringify(output, null, 2)
      );

      console.log("âœ… history_real_tempo.json generated:", output.length, "days");
    })();
    EOF
